<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Chambres – Hôtel Louvain</title>
  <link rel="stylesheet" href="/style.css" />
</head>
<body>
<div class="page">

  <!-- NAVBAR -->
  <header class="nav">
    <div class="nav-inner">
      <div class="nav-left">
        <a class="navlink" href="/">Accueil</a>
        <a class="navlink" href="/rooms">Chambres</a>
        <% if (user) { %>
          <a class="navlink" href="/my-reservations">Mes réservations</a>
        <% } %>
      </div>

      <div class="nav-right">
        <% if (user) { %>
          <span class="pill"><%= user.username %></span>
          <a class="navlink" href="/logout">Déconnexion</a>
        <% } else { %>
          <a class="navlink" href="/login">Connexion</a>
          <a class="navbtn" href="/register">Inscription</a>
        <% } %>
      </div>
    </div>
  </header>

  <!-- CONTENU -->
  <main class="main">
    <div class="shell">
      <section class="panel">
        <h1 class="h1">Chambres</h1>
        <p class="muted">Recherchez et filtrez les chambres disponibles.</p>

        <!-- Recherche + filtre -->
        <form method="GET" action="/rooms" class="rooms-search">
          <input
            type="text"
            name="q"
            placeholder="Rechercher par nom (ex: Suite, 101...)"
            value="<%= q || '' %>"
          />

          <select name="type">
            <option value="all" <%= type === 'all' ? 'selected' : '' %>>Toutes</option>
            <option value="single" <%= type === 'single' ? 'selected' : '' %>>Single</option>
            <option value="double" <%= type === 'double' ? 'selected' : '' %>>Double</option>
            <option value="suite" <%= type === 'suite' ? 'selected' : '' %>>Suite</option>
          </select>

          <button class="btn" type="submit">Rechercher</button>
        </form>

        <!-- LISTE DES CHAMBRES -->
        <% if (!rooms || rooms.length === 0) { %>
          <p class="muted" style="margin-top:18px;">
            Aucune chambre ne correspond à votre recherche.
          </p>
        <% } else { %>
          <div class="grid">
            <% rooms.forEach(room => { %>
              <div class="card">

                <!-- IMAGE AVEC FALLBACK -->
                <img
                  src="<%= room.imageUrl || '' %>"
                  alt="<%= room.name %>"
                  class="room-img"
                  onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1505693416388-ac5ce068fe85?auto=format&fit=crop&w=1200&q=80';"
                />

                <div class="top">
                  <h3><%= room.name %></h3>
                  <span class="badge"><%= room.type %></span>
                </div>

                <p class="muted">
                  Capacité : <strong><%= room.capacity %></strong>
                </p>

                <p class="price"><%= room.pricePerNight %> € / nuit</p>

                <a class="link" href="/rooms/<%= room._id %>">
                  Voir les détails →
                </a>
              </div>
            <% }) %>
          </div>
        <% } %>

      </section>
    </div>
  </main>

  <footer class="footer">Hôtel Louvain
